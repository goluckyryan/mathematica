(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     33170,        779]
NotebookOptionsPosition[     32370,        747]
NotebookOutlinePosition[     32727,        763]
CellTagsIndexPosition[     32684,        760]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Rotx", "[", "\[Theta]_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Roty", "[", "\[Theta]_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "0", ",", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0", ",", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rotz", "[", "\[Theta]_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.571314321979781*^9, 3.5713144170592194`*^9}, {
  3.571314706529776*^9, 3.5713147087169013`*^9}, {3.571314745531007*^9, 
  3.571314747360111*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}], " ", "=", " ", 
     RowBox[{"rotation", " ", "axis"}]}], ",", " ", 
    RowBox[{
    "\[Gamma]", " ", "is", " ", "the", " ", "rotation", " ", "angle"}]}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"Black", ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Eular", " ", "Axis", " ", "Y", " ", "axis"}], "*)"}], " ", 
       "Gray", ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{
           RowBox[{"Rotz", "[", "\[Alpha]", "]"}], ".", 
           RowBox[{"Roty", "[", "\[Beta]", "]"}], ".", 
           RowBox[{"Rotz", "[", "\[Gamma]", "]"}], ".", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "Original", " ", "*)"}], "Red", ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "\[Phi]", "]"}], 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
            RowBox[{
             RowBox[{"Sin", "[", "\[Phi]", "]"}], 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Rotating", " ", "axis"}], ",", " ", 
         RowBox[{"Eular", " ", "Z", " ", "axis"}]}], "*)"}], "Orange", ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "\[Alpha]", "]"}], 
             RowBox[{"Sin", "[", "\[Beta]", "]"}]}], ",", 
            RowBox[{
             RowBox[{"Sin", "[", "\[Alpha]", "]"}], 
             RowBox[{"Sin", "[", "\[Beta]", "]"}]}], ",", 
            RowBox[{"Cos", "[", "\[Beta]", "]"}]}], "}"}]}], "}"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Eular", " ", "Rotated"}], ",", " ", 
         RowBox[{"Eular", " ", "X", " ", "axis"}]}], "*)"}], "Blue", ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{
           RowBox[{"Rotz", "[", "\[Alpha]", "]"}], ".", 
           RowBox[{"Roty", "[", "\[Beta]", "]"}], ".", 
           RowBox[{"Rotz", "[", "\[Gamma]", "]"}], ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", "\[Phi]", "]"}], 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
             RowBox[{
              RowBox[{"Sin", "[", "\[Phi]", "]"}], 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}]}], "}"}], "]"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Rotated", " ", "on", " ", "Rotating", " ", "axis"}], " ", 
        "*)"}], "Purple", ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{
           RowBox[{"Rotz", "[", "\[Alpha]", "]"}], ".", 
           RowBox[{"Roty", "[", "\[Beta]", "]"}], ".", 
           RowBox[{"Rotz", "[", "\[Gamma]", "]"}], ".", 
           RowBox[{"Roty", "[", 
            RowBox[{"-", "\[Beta]"}], "]"}], ".", 
           RowBox[{"Rotz", "[", 
            RowBox[{"-", "\[Alpha]"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", "\[Phi]", "]"}], 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
             RowBox[{
              RowBox[{"Sin", "[", "\[Phi]", "]"}], 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}]}], "}"}], 
        "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]", 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "0", ",", "\[Pi]"}], "}"}],
     ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "0", ",", 
      RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Alpha]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Beta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Gamma]", ",", "0", ",", 
      RowBox[{"4", "\[Pi]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5713144303359785`*^9, 3.571314621907936*^9}, {
   3.571314666245472*^9, 3.571314666700498*^9}, {3.5713147278359947`*^9, 
   3.5713147348683968`*^9}, {3.5713151276888647`*^9, 
   3.5713151351792936`*^9}, {3.5713151915645185`*^9, 3.571315247077694*^9}, {
   3.571315298749649*^9, 3.5713153224140024`*^9}, {3.571315395133162*^9, 
   3.5713154675903063`*^9}, {3.571702290064926*^9, 3.5717022953292274`*^9}, 
   3.5717023818091736`*^9, {3.5717024377363725`*^9, 3.571702464551906*^9}, {
   3.571702554504051*^9, 3.571702559346328*^9}, {3.5717025927532387`*^9, 
   3.571702609152177*^9}, {3.571702639187895*^9, 3.57170264014495*^9}, {
   3.57170268631859*^9, 3.571702697234215*^9}, {3.5717027654861183`*^9, 
   3.5717027761677294`*^9}, {3.571702819104185*^9, 3.5717028223053684`*^9}, {
   3.5717028831718497`*^9, 3.5717029096173625`*^9}, {3.571702983224572*^9, 
   3.5717029895379333`*^9}, {3.5717030314803324`*^9, 3.571703037800694*^9}, {
   3.5717031181092873`*^9, 3.571703133778184*^9}, {3.5717032041102066`*^9, 
   3.5717032049162526`*^9}, {3.5717032424323983`*^9, 
   3.5717032429964304`*^9}, {3.575700028124811*^9, 3.575700047843761*^9}, {
   3.5757000925736437`*^9, 3.575700133330329*^9}, {3.575700213573951*^9, 
   3.575700289907731*^9}, {3.575700453951816*^9, 3.5757004827434797`*^9}, {
   3.575700521023026*^9, 3.575700532878298*^9}, {3.575700943005151*^9, 
   3.575700974951333*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`\[Alpha]$$ = 
    0.6785840131753953, $CellContext`\[Beta]$$ = 
    1.017876019763093, $CellContext`\[Gamma]$$ = 0., $CellContext`\[Theta]$$ =
     0.9676105373056563, $CellContext`\[Phi]$$ = 0.6911503837897545, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`\[Theta]$$], Rational[1, 2] Pi}, 0, Pi}, {
      Hold[$CellContext`\[Phi]$$], 0, 2 Pi}, {
      Hold[$CellContext`\[Alpha]$$], 0, Pi}, {
      Hold[$CellContext`\[Beta]$$], 0, Pi}, {
      Hold[$CellContext`\[Gamma]$$], 0, 4 Pi}}, Typeset`size$$ = {
    262., {183., 188.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`\[Theta]$32801$$ = 
    0, $CellContext`\[Phi]$32802$$ = 0, $CellContext`\[Alpha]$32803$$ = 
    0, $CellContext`\[Beta]$32804$$ = 0, $CellContext`\[Gamma]$32805$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`\[Alpha]$$ = 0, $CellContext`\[Beta]$$ = 
        0, $CellContext`\[Gamma]$$ = 0, $CellContext`\[Theta]$$ = 
        Rational[1, 2] Pi, $CellContext`\[Phi]$$ = 0}, "ControllerVariables" :> {
        Hold[$CellContext`\[Theta]$$, $CellContext`\[Theta]$32801$$, 0], 
        Hold[$CellContext`\[Phi]$$, $CellContext`\[Phi]$32802$$, 0], 
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$32803$$, 0], 
        Hold[$CellContext`\[Beta]$$, $CellContext`\[Beta]$32804$$, 0], 
        Hold[$CellContext`\[Gamma]$$, $CellContext`\[Gamma]$32805$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Graphics3D[{Black, 
         Arrow[{{0, 0, 0}, {1, 0, 0}}], 
         Arrow[{{0, 0, 0}, {0, 1, 0}}], 
         Arrow[{{0, 0, 0}, {0, 0, 1}}], Gray, 
         Arrow[{{0, 0, 0}, 
           Dot[
            $CellContext`Rotz[$CellContext`\[Alpha]$$], 
            $CellContext`Roty[$CellContext`\[Beta]$$], 
            $CellContext`Rotz[$CellContext`\[Gamma]$$], {0, 1, 0}]}], Red, 
         Arrow[{{0, 0, 0}, {
           Cos[$CellContext`\[Phi]$$] Sin[$CellContext`\[Theta]$$], 
            Sin[$CellContext`\[Phi]$$] Sin[$CellContext`\[Theta]$$], 
            Cos[$CellContext`\[Theta]$$]}}], Orange, 
         Arrow[{{0, 0, 0}, {
           Cos[$CellContext`\[Alpha]$$] Sin[$CellContext`\[Beta]$$], 
            Sin[$CellContext`\[Alpha]$$] Sin[$CellContext`\[Beta]$$], 
            Cos[$CellContext`\[Beta]$$]}}], Blue, 
         Arrow[{{0, 0, 0}, 
           Dot[
            $CellContext`Rotz[$CellContext`\[Alpha]$$], 
            $CellContext`Roty[$CellContext`\[Beta]$$], 
            $CellContext`Rotz[$CellContext`\[Gamma]$$], {
            Cos[$CellContext`\[Phi]$$] Sin[$CellContext`\[Theta]$$], 
             Sin[$CellContext`\[Phi]$$] Sin[$CellContext`\[Theta]$$], 
             Cos[$CellContext`\[Theta]$$]}]}], Purple, 
         Arrow[{{0, 0, 0}, 
           Dot[
            $CellContext`Rotz[$CellContext`\[Alpha]$$], 
            $CellContext`Roty[$CellContext`\[Beta]$$], 
            $CellContext`Rotz[$CellContext`\[Gamma]$$], 
            $CellContext`Roty[-$CellContext`\[Beta]$$], 
            $CellContext`Rotz[-$CellContext`\[Alpha]$$], {
            Cos[$CellContext`\[Phi]$$] Sin[$CellContext`\[Theta]$$], 
             Sin[$CellContext`\[Phi]$$] Sin[$CellContext`\[Theta]$$], 
             Cos[$CellContext`\[Theta]$$]}]}]}], 
      "Specifications" :> {{{$CellContext`\[Theta]$$, Rational[1, 2] Pi}, 0, 
         Pi}, {$CellContext`\[Phi]$$, 0, 2 Pi}, {$CellContext`\[Alpha]$$, 0, 
         Pi}, {$CellContext`\[Beta]$$, 0, Pi}, {$CellContext`\[Gamma]$$, 0, 4 
         Pi}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{305., {281., 287.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.5713146054409943`*^9, 3.571314622455967*^9}, 
   3.571314667551547*^9, 3.5713147353344235`*^9, 3.571315136180351*^9, {
   3.571315244461544*^9, 3.5713152495858374`*^9}, 3.5713153232840524`*^9, {
   3.5713154209526386`*^9, 3.5713154684343543`*^9}, {3.571702279027295*^9, 
   3.5717022958732586`*^9}, 3.5717023832952585`*^9, {3.5717024437987194`*^9, 
   3.571702465700972*^9}, 3.5717026104122486`*^9, 3.5717026422640705`*^9, 
   3.571702697782246*^9, 3.571702776792765*^9, 3.5717028229554057`*^9, {
   3.57170290660219*^9, 3.5717029100863895`*^9}, 3.571702990073964*^9, 
   3.571703038983762*^9, 3.5717031352202663`*^9, 3.5717032054062805`*^9, 
   3.575700176000929*^9, 3.575700290420785*^9, 3.575700484199222*^9, 
   3.5757009762427397`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Application to Multi - scattering ", "Section",
 CellChangeTimes->{{3.5757005988776827`*^9, 3.575700605206846*^9}, {
  3.5757007475384398`*^9, 3.5757007558962173`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"UnScat", "[", 
   RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "\[Phi]", "]"}], 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Phi]", "]"}], 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.575700769521617*^9, 3.575700784881712*^9}, 
   3.575701001112626*^9, {3.575701041859865*^9, 3.5757011618346663`*^9}, {
   3.575701205953926*^9, 3.575701221599477*^9}, {3.5757013078867607`*^9, 
   3.5757013082690973`*^9}, {3.575701365274*^9, 3.5757013876358624`*^9}, {
   3.575702433141531*^9, 3.57570243365429*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "assume", " ", "the", " ", "change", " ", "of", " ", "angle", " ", "is", 
    " ", "small"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "use", " ", "UnScat", " ", "as", " ", "normal", " ", "to", " ", "general", 
    " ", "a", " ", "plane", " ", "on", " ", "a", " ", "unit", " ", "sphere"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "then", " ", "pick", " ", "a", " ", "random", " ", "point", " ", "inside",
      " ", "the", " ", "circle", " ", "with", " ", "r"}], "=", 
    RowBox[{
     RowBox[{"\[Theta]", " ", "and", " ", "\[Phi]"}], "=", 
     RowBox[{"random", "[", 
      RowBox[{"0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "the", " ", "basis", " ", "for", " ", "the", " ", "plane", " ", "is"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"basis1", "[", "V_", "]"}], ":=", 
    RowBox[{"Normalize", "[", 
     RowBox[{"Cross", "[", 
      RowBox[{"V", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"basis2", "[", "V_", "]"}], ":=", 
    RowBox[{"Normalize", "[", 
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"basis1", "[", "V", "]"}], ",", "V"}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]r", "[", 
     RowBox[{"V_", ",", "\[Alpha]_", ",", "\[Beta]_"}], "]"}], ":=", 
    RowBox[{"\[Beta]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"basis1", "[", "V", "]"}], 
        RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"basis2", "[", "V", "]"}], 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Scated", "[", 
     RowBox[{"V_", ",", "\[Beta]_"}], "]"}], ":=", 
    RowBox[{"Normalize", "[", 
     RowBox[{"V", "+", 
      RowBox[{"\[CapitalDelta]r", "[", 
       RowBox[{"V", ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"2", "\[Pi]"}]}], "}"}], "]"}], ",", "\[Beta]"}], "]"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.575701338938623*^9, 3.575701341551936*^9}, {
  3.575701744051094*^9, 3.575701883524934*^9}, {3.5757019877187*^9, 
  3.5757020949922447`*^9}, {3.575702179833694*^9, 3.575702210398704*^9}, {
  3.575702243390893*^9, 3.5757023154135*^9}, {3.5757024297453527`*^9, 
  3.575702487221107*^9}, {3.575702790680408*^9, 3.575702797010992*^9}, {
  3.575704249634156*^9, 3.575704302946704*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetScated", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Scated", "[", 
      RowBox[{
       RowBox[{"UnScat", "[", 
        RowBox[{"1", ",", "1"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetArrow", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Arrow", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"SetScated", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.575702514872197*^9, 3.575702621997699*^9}, {
  3.575702715306271*^9, 3.575702739882552*^9}, {3.5757028719127502`*^9, 
  3.575702872342208*^9}, {3.575702941380965*^9, 3.5757029424039183`*^9}, {
  3.5757030294101562`*^9, 3.575703044625024*^9}, {3.575704323218361*^9, 
  3.575704435240633*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"ArcCos", "[", 
    RowBox[{
     RowBox[{"SetScated", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ".", 
     RowBox[{"UnScat", "[", 
      RowBox[{"1", ",", "1"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.575702693566846*^9, 3.575702698554431*^9}, {
  3.575702749266653*^9, 3.575702773650324*^9}, {3.575702806256094*^9, 
  3.575702810441881*^9}, {3.575702972130232*^9, 3.57570298547392*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.024112121653609334`", ",", "0.04124982348293014`", ",", 
   "0.021155519246545726`", ",", "0.04317411837657914`", ",", 
   "0.00644480897347046`", ",", "0.04935449453080333`", ",", 
   "0.01964321991203349`", ",", "0.002333002488606806`", ",", 
   "0.029785666572839972`", ",", "0.006516643011362543`"}], "}"}]], "Output",
 CellChangeTimes->{{3.575702774140235*^9, 3.575702810900383*^9}, 
   3.57570287463735*^9, {3.5757029461681137`*^9, 3.575702985987259*^9}, {
   3.575703032184971*^9, 3.575703046918085*^9}, {3.5757043272807007`*^9, 
   3.575704352551393*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics3D", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{"Red", ",", 
    RowBox[{"Arrow", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"UnScat", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], "}"}], "]"}], ",", 
    "\[IndentingNewLine]", "Black", ",", "SetArrow"}], "\[IndentingNewLine]", 
   "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.5757025929830513`*^9, 3.575702598157158*^9}, {
  3.575702628557164*^9, 3.575702678307683*^9}}],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[1, 0, 0], 
    Arrow3DBox[
     NCache[{{0, 0, 0}, {Cos[1] Sin[1], Sin[1]^2, Cos[1]}}, {{0, 0, 0}, {
       0.4546487134128409, 0.7080734182735712, 0.5403023058681398}}]]}, 
   {GrayLevel[0], 
    Arrow3DBox[{{0, 0, 0}, {0.13746137033469358`, 0.820384712987747, 
      0.5550435067287248}}], 
    Arrow3DBox[{{0, 0, 0}, {0.07382845790950511, 0.6691630247713526, 
      0.7394391151958074}}], 
    Arrow3DBox[{{0, 0, 0}, {0.38210208970859144`, 0.7866980464659173, 
      0.48487542392560706`}}], 
    Arrow3DBox[{{0, 0, 0}, {-0.08742510314336123, 0.9192208993827293, 
      0.3839137787034722}}], 
    Arrow3DBox[{{0, 0, 0}, {0.5014133495149038, 0.1334608550554656, 
      0.8548525329529703}}], 
    Arrow3DBox[{{0, 0, 0}, {0.7720738094243187, 
      0.6227891302398978, -0.12663227098987154`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.5309471855689033, 0.4557854626087158, 
      0.7143911381106427}}], 
    Arrow3DBox[{{0, 0, 0}, {0.4906898365096544, 0.6892459649886882, 
      0.533069867928155}}], 
    Arrow3DBox[{{0, 0, 0}, {-0.20403656151373756`, 0.9170881057060942, 
      0.3425178651370736}}], 
    Arrow3DBox[{{0, 0, 0}, {0.6839631367115899, 0.1837986039120164, 
      0.7059833573248286}}], 
    Arrow3DBox[{{0, 0, 0}, {0.03900112975052519, 0.9968580191365668, 
      0.06894201593587622}}], 
    Arrow3DBox[{{0, 0, 0}, {0.37867315645876143`, 0.7194952757479678, 
      0.5821796876857817}}], 
    Arrow3DBox[{{0, 0, 0}, {0.6078988954611771, 0.7937362553679276, 
      0.021016417667642062`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.4864900747688847, 0.05200391026543541, 
      0.872137030786143}}], 
    Arrow3DBox[{{0, 0, 0}, {0.5247355276956399, 0.8174591414670436, 
      0.2375145848278425}}], 
    Arrow3DBox[{{0, 0, 0}, {0.44713086503634636`, 0.6994814749952121, 
      0.557494085771653}}], 
    Arrow3DBox[{{0, 0, 0}, {0.9400721631561382, 0.19595533865535275`, 
      0.2790445005933739}}], 
    Arrow3DBox[{{0, 0, 0}, {0.24230948017840753`, 0.9240700125170364, 
      0.295602313560693}}], 
    Arrow3DBox[{{0, 0, 0}, {0.3872712417547391, 0.6441658561973351, 
      0.6595993746353136}}], 
    Arrow3DBox[{{0, 0, 0}, {0.5508402378945805, 0.5978628526434832, 
      0.5823530215816166}}], 
    Arrow3DBox[{{0, 0, 0}, {0.26866347718680483`, 0.2680953990337628, 
      0.9251728449553753}}], 
    Arrow3DBox[{{0, 0, 0}, {0.7381345582718467, 0.2757358643978824, 
      0.6157329834998109}}], 
    Arrow3DBox[{{0, 0, 0}, {0.4458771677570755, 0.6118159746647829, 
      0.6533565369826115}}], 
    Arrow3DBox[{{0, 0, 0}, {0.4958732084941253, 
      0.8592024634792271, -0.12601939473338636`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.7886986249297825, 0.5041716010990533, 
      0.35180317747156215`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.5666226003243345, 0.4001997363725249, 
      0.720263146224386}}], 
    Arrow3DBox[{{0, 0, 0}, {0.062453926716495634`, 0.8196694251535416, 
      0.5694221110091819}}], 
    Arrow3DBox[{{0, 0, 0}, {0.746775392494215, 0.6332581102820349, 
      0.20325028641342033`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.8868415198723278, 0.35155066467299384`, 
      0.29987372142039304`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.46711040151959077`, 0.7380290319283336, 
      0.4869507375732513}}], 
    Arrow3DBox[{{0, 0, 0}, {0.24833770497654198`, 0.9595148306505893, 
      0.13288970633030467`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.24761434894417253`, 0.9643361079367332, 
      0.09350403802182397}}], 
    Arrow3DBox[{{0, 0, 0}, {-0.09085074462215899, 0.9542817057467625, 
      0.28476756886739824`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.32441664455291885`, 0.3118463558238986, 
      0.8930317413711448}}], 
    Arrow3DBox[{{0, 0, 0}, {0.4956058828805577, 0.7396386864176869, 
      0.4553124448205885}}], 
    Arrow3DBox[{{0, 0, 0}, {-0.25766091890635134`, 0.5740292055626685, 
      0.7772395525379718}}], 
    Arrow3DBox[{{0, 0, 0}, {0.16480236295327794`, 0.7460667422938497, 
      0.6451547079639569}}], 
    Arrow3DBox[{{0, 0, 0}, {0.4477525720800935, 0.7085409522625699, 
      0.5454240122716558}}], 
    Arrow3DBox[{{0, 0, 0}, {0.5988357089395504, 0.5993155310306914, 
      0.5312407062380163}}], 
    Arrow3DBox[{{0, 0, 0}, {0.4389715297371946, 0.695223934545414, 
      0.5691815851864684}}], 
    Arrow3DBox[{{0, 0, 0}, {0.3237250315811462, 0.5788253256752889, 
      0.7484406097244336}}], 
    Arrow3DBox[{{0, 0, 0}, {0.7416395969276254, 0.5106614028820091, 
      0.43496625142142714`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.5656118399855544, 0.2473551316670119, 
      0.7867011410352415}}], 
    Arrow3DBox[{{0, 0, 0}, {0.4329344535254026, 0.2114036586955714, 
      0.8762854854673716}}], 
    Arrow3DBox[{{0, 0, 0}, {0.5339895327223851, 0.06334153863040924, 
      0.8431150742495719}}], 
    Arrow3DBox[{{0, 0, 0}, {0.3468695947458135, 
      0.926425985459842, -0.1463433555226735}}], 
    Arrow3DBox[{{0, 0, 0}, {0.838689478075923, 0.5444953404597584, 
      0.01117065720304021}}], 
    Arrow3DBox[{{0, 0, 0}, {0.6206122082380957, 0.47717567186264004`, 
      0.6222088597635627}}], 
    Arrow3DBox[{{0, 0, 0}, {0.414578542964278, 0.7106386227511946, 
      0.5684341470811739}}], 
    Arrow3DBox[{{0, 0, 0}, {0.7495977250055499, 0.6494485111239605, 
      0.1277492937959925}}], 
    Arrow3DBox[{{0, 0, 0}, {0.4359738475963497, 0.6905547486996676, 
      0.5771143242550594}}], 
    Arrow3DBox[{{0, 0, 0}, {-0.005076862410475268, 0.46540602129282926`, 
      0.8850827423537551}}], 
    Arrow3DBox[{{0, 0, 0}, {0.4533907123283026, 0.6440280568552443, 
      0.6161693955055642}}], 
    Arrow3DBox[{{0, 0, 0}, {0.7721166412695284, 0.1859225170183598, 
      0.6076748389889283}}], 
    Arrow3DBox[{{0, 0, 0}, {0.4143651770777049, 0.1972431354934106, 
      0.888479963491631}}], 
    Arrow3DBox[{{0, 0, 0}, {0.35826692961469514`, 0.8352766013147436, 
      0.41708249356757937`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.6324258183741492, 0.7125899277698243, 
      0.30373208440134225`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.049111007037485645`, 0.9090295510551705, 
      0.413827722967178}}], 
    Arrow3DBox[{{0, 0, 0}, {0.862565631144796, 0.21653411712533488`, 
      0.4572674360683598}}], 
    Arrow3DBox[{{0, 0, 0}, {0.4556637673577791, 0.7748589035745705, 
      0.43813720530049777`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.8132499993006213, 0.4743281452955502, 
      0.33710124475893416`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.39850208049431757`, 0.2584854882540932, 
      0.879989400051923}}], 
    Arrow3DBox[{{0, 0, 0}, {0.028295646177334006`, 0.30308199052079465`, 
      0.9525443104808091}}], 
    Arrow3DBox[{{0, 0, 0}, {0.5765225980072943, 0.05589773368276019, 
      0.8151669383359774}}], 
    Arrow3DBox[{{0, 0, 0}, {0.006328445929811011, 0.9952192988053883, 
      0.09746023834069269}}], 
    Arrow3DBox[{{0, 0, 0}, {0.6288990760121791, 0.716962569674128, 
      0.3007501053653992}}], 
    Arrow3DBox[{{0, 0, 0}, {0.3010751007095544, 
      0.952186837766072, -0.051903850702808764`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.10821416616819234`, 0.9941275322162367, 
      0.00037938130968210063`}}], 
    Arrow3DBox[{{0, 0, 0}, {-0.20215454471021918`, 0.627568512965963, 
      0.7518585648821821}}], 
    Arrow3DBox[{{0, 0, 0}, {0.7034765175210748, 0.6668371379446733, 
      0.24586382563154258`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.22831337892196382`, 0.6500712900102666, 
      0.7247622499203611}}], 
    Arrow3DBox[{{0, 0, 0}, {0.5966780739593267, 0.43505227228256643`, 
      0.6743180232189879}}], 
    Arrow3DBox[{{0, 0, 0}, {0.622002693996322, 0.712910230150287, 
      0.3238389297295527}}], 
    Arrow3DBox[{{0, 0, 0}, {0.4542492203159908, 0.7493727287809798, 
      0.48176566835097584`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.4553557898856881, 0.7149082157169068, 
      0.5306197769759904}}], 
    Arrow3DBox[{{0, 0, 0}, {-0.19537201982375502`, 0.8877462587668343, 
      0.4168169309366827}}], 
    Arrow3DBox[{{0, 0, 0}, {0.4516701120277303, 0.7178721020889839, 
      0.5297676424086326}}], 
    Arrow3DBox[{{0, 0, 0}, {0.3561568404375228, 0.9326703804349467, 
      0.057256147869835634`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.7525478104487976, 0.646917380550159, 
      0.12316531870149779`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.34120020967310827`, 0.7650194355049503, 
      0.5461938119557141}}], 
    Arrow3DBox[{{0, 0, 0}, {0.8457866204595963, 0.12888526051915772`, 
      0.517719598115084}}], 
    Arrow3DBox[{{0, 0, 0}, {0.4894664191307317, 0.7046505074447741, 
      0.5137025276375047}}], 
    Arrow3DBox[{{0, 0, 0}, {0.6127112960860277, 0.7569063757283764, 
      0.22732709040128574`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.43476335489503337`, 0.6067078719854666, 
      0.6654970948931949}}], 
    Arrow3DBox[{{0, 0, 0}, {0.562491577617019, 0.6960452151987435, 
      0.4462334405990346}}], 
    Arrow3DBox[{{0, 0, 0}, {0.2921080712690554, 0.9194231637103507, 
      0.26331335084329094`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.637328752934793, 0.617577315657271, 
      0.4608799408394135}}], 
    Arrow3DBox[{{0, 0, 0}, {0.7960645794458256, 0.511605648685493, 
      0.32332776803862173`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.03783533910089102, 0.747755899028619, 
      0.6628948654070436}}], 
    Arrow3DBox[{{0, 0, 0}, {-0.016750981406882647`, 0.9879286902211528, 
      0.1540009988922913}}], 
    Arrow3DBox[{{0, 0, 0}, {0.46246601694458667`, 0.8035539483102206, 
      0.3747348867218854}}], 
    Arrow3DBox[{{0, 0, 0}, {0.5330995672374713, 0.798593511229896, 
      0.2793801267676835}}], 
    Arrow3DBox[{{0, 0, 0}, {0.6494357020656867, 0.010077810806207342`, 
      0.7603497265152419}}], 
    Arrow3DBox[{{0, 0, 0}, {0.43612893226571875`, 0.8985085741556317, 
      0.04973828112809884}}], 
    Arrow3DBox[{{0, 0, 0}, {-0.154613348986149, 0.7926415541631989, 
      0.5897576442311161}}], 
    Arrow3DBox[{{0, 0, 0}, {0.46396787429291464`, 0.6735861324680416, 
      0.5753394943603819}}], 
    Arrow3DBox[{{0, 0, 0}, {-0.09855943031602794, 0.5038178134038145, 
      0.8581687768689671}}], 
    Arrow3DBox[{{0, 0, 0}, {0.2115028121983459, 
      0.9729668033541587, -0.09274783017936816}}], 
    Arrow3DBox[{{0, 0, 0}, {0.3073365712038246, 0.8596754567237533, 
      0.40804698394606764`}}], 
    Arrow3DBox[{{0, 0, 0}, {0.7627052261459937, 0.6432790651523026, 
      0.06687886322574786}}]}},
  AutomaticImageSize->True,
  ImageSize->{408.9394094506261, 311.8665774419076},
  ViewPoint->{1.0796238173402928`, -1.795269151915922, 2.6573334538989775`},
  ViewVertical->{0.2634366182055616, 0.20386744072712462`, 
   1.006829079665846}]], "Output",
 CellChangeTimes->{{3.575702598672858*^9, 3.575702679162319*^9}, 
   3.575702743349996*^9, 3.575702803238028*^9, 3.575702878650189*^9, 
   3.575702948233612*^9, {3.5757030341514063`*^9, 3.5757030554576607`*^9}, {
   3.575704329015094*^9, 3.575704354100656*^9}, {3.5757043899288282`*^9, 
   3.575704438045076*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{959, 741},
WindowMargins->{{Automatic, 121}, {Automatic, 0}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 23, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 1728, 50, 58, "Input"],
Cell[CellGroupData[{
Cell[2310, 74, 7384, 175, 238, "Input"],
Cell[9697, 251, 5158, 92, 585, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14892, 348, 174, 2, 67, "Section"],
Cell[15069, 352, 751, 17, 27, "Input"],
Cell[15823, 371, 2723, 71, 133, "Input"],
Cell[18549, 444, 1177, 32, 43, "Input"],
Cell[CellGroupData[{
Cell[19751, 480, 538, 13, 27, "Input"],
Cell[20292, 495, 608, 11, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20937, 511, 559, 14, 73, "Input"],
Cell[21499, 527, 10843, 216, 327, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
